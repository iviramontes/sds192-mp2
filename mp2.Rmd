---
title: "Mini-Project 2"
author: "Guadalupe Chimil, Annah Lee, Ivette Viramontes"
date: "March 22, 2018"
output:
  pdf_document: default
  html_document: default
---

## Loading the data
```{r, include=FALSE} 
load("committees.rda")
load("individuals.rda")  
library(gridExtra) 
```

```{r}
NatComm <- individuals %>% 
  full_join(x=individuals, y=committees, by="cmte_id") %>%
  filter(transaction_type == "11", 
         entity_type == "IND"| entity_type == "ORG",
         transaction_pgi == "G",
         cmte_type == "H"|cmte_type == "S"|cmte_type == "P",
         cmte_party_affiliation == "DEM" | 
         cmte_party_affiliation == "REP" ) %>% 
  select(cmte_id, transaction_pgi, transaction_type, entity_type,
         transaction_amt, cmte_type, cmte_party_affiliation) 

ggplot(data=NatComm, aes(x=cmte_type, y=transaction_amt,
                     fill=cmte_party_affiliation))+
        geom_bar(stat="identity")+
  ggtitle("Native American Contributions to the General Elections")+
  labs(x="General Elections", y="Amount Donated ($)", fill= "Party Affiliation")+
#themes
  theme(plot.title = element_text(family="Arial",
                                  face= "bold", size = 25)) +
  theme(axis.title = element_text(family = "Arial",
                                  face="bold", size=16)) +
  theme(legend.title= element_text(family = "Arial",
                                   face ="bold", size =14)) +
  scale_fill_manual(values = c("blue","red")) +
  theme(panel.background = element_blank()) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
  scale_y_continuous(breaks= c(0,400000,800000,1200000), label=c("$0","$400,000", "$800,000", "$1,200,000"))
```

```{r}
house <- NatComm %>%
  filter(cmte_type == "H")
ggplot(house, aes(x=cmte_type, y=transaction_amt,
                     fill=cmte_party_affiliation))+
        geom_bar(stat="identity")+
ggtitle("Native American Contributions to the House General Elections") +
  labs(x="House Elections", y="Amount Donated ($)", fill= "Party Affiliation") +
  theme(plot.title = element_text(family="Arial",
                                  face= "bold", size = 12))+
  theme(axis.title = element_text(family = "Arial",
                                  face="bold", size=10))+
  theme(legend.title= element_text(family = "Arial",
                                   face ="bold", size =8))+
  scale_fill_manual(values = c("blue","red"))+
  theme(panel.background = element_blank())+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())
  
presidential <- NatComm %>%
  filter(cmte_type == "P")
ggplot(presidential, aes(x=cmte_type, y=transaction_amt,
                     fill=cmte_party_affiliation))+
        geom_bar(stat="identity")+
ggtitle("Native American Contributions to the Presidential General Elections") +
  labs(x="Presidential Elections", y="Amount Donated ($)", fill= "Party Affiliation") +
  theme(plot.title = element_text(family="Arial",
                                  face= "bold", size = 12))+
  theme(axis.title = element_text(family = "Arial",
                                  face="bold", size=10))+
  theme(legend.title= element_text(family = "Arial",
                                   face ="bold", size =8))+
  scale_fill_manual(values = c("blue","red"))+
  theme(panel.background = element_blank())+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())

senate <- NatComm %>%
  filter(cmte_type == "S")
ggplot(senate, aes(x=cmte_type, y=transaction_amt,
                     fill=cmte_party_affiliation))+
        geom_bar(stat="identity")+
ggtitle("Native American Contributions to the Senate General Elections") +
  labs(x="Senate Elections", y="Amount Donated ($)", fill= "Party Affiliation") +
  theme(plot.title = element_text(family="Arial",
                                  face= "bold", size = 12))+
  theme(axis.title = element_text(family = "Arial",
                                  face="bold", size=10))+
  theme(legend.title= element_text(family = "Arial",
                                   face ="bold", size =8))+
  scale_fill_manual(values = c("blue","red"))+
  theme(panel.background = element_blank())+
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())

grid.arrange(house, presidential, senate, ncol = 3, nrow = 1)
```
